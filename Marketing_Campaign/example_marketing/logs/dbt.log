

============================== 2022-03-29 13:17:05.393112 | 7b3d61a3-e33e-4e15-aed0-0253f745335d ==============================
13:17:05.393663 [info ] [MainThread]: Running with dbt=1.0.1
13:17:05.400165 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:17:05.407452 [debug] [MainThread]: Tracking: tracking
13:17:05.479589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d5820>]}
13:17:06.105500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:17:06.112343 [debug] [MainThread]: Partial parsing: updated file: Marketing://models/example/orders_and_customers.sql
13:17:06.340023 [debug] [MainThread]: 1699: static parser successfully parsed example/orders_and_customers.sql
13:17:06.656562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b3d61a3-e33e-4e15-aed0-0253f745335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4027fee0d0>]}
13:17:06.779173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b3d61a3-e33e-4e15-aed0-0253f745335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007672190>]}
13:17:06.788916 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
13:17:06.823211 [info ] [MainThread]: 
13:17:06.834431 [debug] [MainThread]: Acquiring new postgres connection "master"
13:17:06.854635 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
13:17:07.179134 [debug] [ThreadPool]: Using postgres connection "list_testme"
13:17:07.184995 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
13:17:07.189561 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:17:07.344508 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.15 seconds
13:17:09.444006 [debug] [ThreadPool]: On list_testme: Close
13:17:09.453367 [debug] [ThreadPool]: Acquiring new postgres connection "create_testme_testme_schema"
13:17:09.458888 [debug] [ThreadPool]: Acquiring new postgres connection "create_testme_testme_schema"
13:17:09.463237 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='testme', schema='testme_schema', identifier=None)"
13:17:09.506034 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
13:17:09.510733 [debug] [ThreadPool]: On create_testme_testme_schema: BEGIN
13:17:09.514081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:17:09.603251 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
13:17:09.608153 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
13:17:09.612319 [debug] [ThreadPool]: On create_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "create_testme_testme_schema"} */
create schema if not exists "testme_schema"
13:17:09.618507 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
13:17:09.879190 [debug] [ThreadPool]: On create_testme_testme_schema: COMMIT
13:17:09.884287 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
13:17:09.888199 [debug] [ThreadPool]: On create_testme_testme_schema: COMMIT
13:17:09.895477 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
13:17:09.899805 [debug] [ThreadPool]: On create_testme_testme_schema: Close
13:17:09.912361 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
13:17:09.967210 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
13:17:09.974906 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
13:17:09.981244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:17:10.073102 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
13:17:10.078506 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
13:17:10.083360 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
13:17:10.097127 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
13:17:10.112233 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
13:17:10.121183 [debug] [ThreadPool]: On list_testme_testme_schema: Close
13:17:10.158511 [debug] [MainThread]: Using postgres connection "master"
13:17:10.165076 [debug] [MainThread]: On master: BEGIN
13:17:10.169872 [debug] [MainThread]: Opening a new connection, currently in state init
13:17:10.263086 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
13:17:10.269570 [debug] [MainThread]: Using postgres connection "master"
13:17:10.276263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
13:17:10.297328 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
13:17:10.311016 [debug] [MainThread]: On master: ROLLBACK
13:17:10.319144 [debug] [MainThread]: Using postgres connection "master"
13:17:10.325237 [debug] [MainThread]: On master: BEGIN
13:17:10.332899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
13:17:10.338129 [debug] [MainThread]: On master: COMMIT
13:17:10.342918 [debug] [MainThread]: Using postgres connection "master"
13:17:10.348097 [debug] [MainThread]: On master: COMMIT
13:17:10.356344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:17:10.362344 [debug] [MainThread]: On master: Close
13:17:10.368640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:17:10.374551 [info ] [MainThread]: 
13:17:10.516252 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
13:17:10.523314 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
13:17:10.532564 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
13:17:10.539099 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
13:17:10.545413 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
13:17:10.669182 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
13:17:10.687580 [debug] [Thread-1  ]: finished collecting timing info
13:17:10.693502 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
13:17:13.301829 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
13:17:13.316198 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
13:17:13.320392 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
13:17:13.324374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:17:13.414939 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
13:17:13.421674 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
13:17:13.426944 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
13:17:13.440992 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
13:17:14.576641 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
13:17:14.582451 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
13:17:14.591319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
13:17:14.693730 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
13:17:14.700400 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
13:17:14.706179 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
13:17:14.713394 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
13:17:14.755397 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
13:17:14.761504 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
13:17:14.768868 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
13:17:14.789670 [debug] [Thread-1  ]: finished collecting timing info
13:17:14.795070 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
13:17:14.801364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b3d61a3-e33e-4e15-aed0-0253f745335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40595ba0d0>]}
13:17:14.810568 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 396[0m in 4.27s]
13:17:14.820030 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
13:17:14.829537 [debug] [Thread-1  ]: Began running node model.Marketing.email_list
13:17:14.836294 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.email_list............................... [RUN]
13:17:14.843973 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.email_list"
13:17:14.851272 [debug] [Thread-1  ]: Began compiling node model.Marketing.email_list
13:17:14.857346 [debug] [Thread-1  ]: Compiling model.Marketing.email_list
13:17:14.880885 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.email_list"
13:17:14.892112 [debug] [Thread-1  ]: finished collecting timing info
13:17:14.898383 [debug] [Thread-1  ]: Began executing node model.Marketing.email_list
13:17:15.999664 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.email_list"
13:17:16.009595 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
13:17:16.013469 [debug] [Thread-1  ]: On model.Marketing.email_list: BEGIN
13:17:16.017317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:17:16.104580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
13:17:16.111524 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
13:17:16.117324 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */


  create  table "testme"."testme_schema"."email_list__dbt_tmp"
  as (
    

-- FIXME: support views
-- Use the `ref` function to select from other models

select email
from "testme"."testme_schema"."orders_and_customers"
  );
13:17:16.131035 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
13:17:16.946382 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
13:17:16.951330 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */
alter table "testme"."testme_schema"."email_list__dbt_tmp" rename to "email_list"
13:17:16.958206 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
13:17:16.990101 [debug] [Thread-1  ]: On model.Marketing.email_list: COMMIT
13:17:16.996175 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
13:17:17.002879 [debug] [Thread-1  ]: On model.Marketing.email_list: COMMIT
13:17:17.010206 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
13:17:17.022814 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
13:17:17.027264 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */
drop table if exists "testme"."testme_schema"."email_list__dbt_backup" cascade
13:17:17.036266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
13:17:18.508302 [debug] [Thread-1  ]: finished collecting timing info
13:17:18.513898 [debug] [Thread-1  ]: On model.Marketing.email_list: Close
13:17:18.520413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b3d61a3-e33e-4e15-aed0-0253f745335d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4059626dc0>]}
13:17:18.528407 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.email_list.......................... [[32mSELECT 396[0m in 3.68s]
13:17:18.536294 [debug] [Thread-1  ]: Finished running node model.Marketing.email_list
13:17:18.544977 [debug] [MainThread]: Acquiring new postgres connection "master"
13:17:18.549805 [debug] [MainThread]: Using postgres connection "master"
13:17:18.553658 [debug] [MainThread]: On master: BEGIN
13:17:18.558580 [debug] [MainThread]: Opening a new connection, currently in state closed
13:17:18.645201 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
13:17:18.651036 [debug] [MainThread]: On master: COMMIT
13:17:18.655840 [debug] [MainThread]: Using postgres connection "master"
13:17:18.661007 [debug] [MainThread]: On master: COMMIT
13:17:18.667654 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
13:17:18.673333 [debug] [MainThread]: On master: Close
13:17:18.679221 [info ] [MainThread]: 
13:17:18.683842 [info ] [MainThread]: Finished running 2 table models in 11.85s.
13:17:18.688393 [debug] [MainThread]: Connection 'master' was properly closed.
13:17:18.694293 [debug] [MainThread]: Connection 'model.Marketing.email_list' was properly closed.
13:17:18.736583 [info ] [MainThread]: 
13:17:18.741651 [info ] [MainThread]: [32mCompleted successfully[0m
13:17:18.747363 [info ] [MainThread]: 
13:17:18.752281 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
13:17:18.757279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403d8950a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403d895e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x405962d280>]}


============================== 2022-03-29 15:32:43.716065 | 2e9d07a0-48e2-4557-976f-856ef5e08554 ==============================
15:32:43.716652 [info ] [MainThread]: Running with dbt=1.0.1
15:32:43.723064 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:32:43.733216 [debug] [MainThread]: Tracking: tracking
15:32:43.763985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c6fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c6670>]}
15:32:44.006297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:32:44.010573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:32:44.058671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e9d07a0-48e2-4557-976f-856ef5e08554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a90d0>]}
15:32:44.113314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e9d07a0-48e2-4557-976f-856ef5e08554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007730d30>]}
15:32:44.118762 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
15:32:44.131544 [info ] [MainThread]: 
15:32:44.138930 [debug] [MainThread]: Acquiring new postgres connection "master"
15:32:44.151762 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
15:32:44.224901 [debug] [ThreadPool]: Using postgres connection "list_testme"
15:32:44.232595 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
15:32:44.238602 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:32:44.354742 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.12 seconds
15:32:46.001251 [debug] [ThreadPool]: On list_testme: Close
15:32:46.012518 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
15:32:46.056578 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:32:46.060969 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
15:32:46.064990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:32:46.149076 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
15:32:46.154243 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:32:46.158375 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
15:32:46.166636 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:32:46.178850 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
15:32:46.183688 [debug] [ThreadPool]: On list_testme_testme_schema: Close
15:32:46.216628 [debug] [MainThread]: Using postgres connection "master"
15:32:46.221076 [debug] [MainThread]: On master: BEGIN
15:32:46.226182 [debug] [MainThread]: Opening a new connection, currently in state init
15:32:46.309932 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
15:32:46.313738 [debug] [MainThread]: Using postgres connection "master"
15:32:46.317449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:32:46.329346 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
15:32:46.340182 [debug] [MainThread]: On master: ROLLBACK
15:32:46.349599 [debug] [MainThread]: Using postgres connection "master"
15:32:46.353214 [debug] [MainThread]: On master: BEGIN
15:32:46.358447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:32:46.362955 [debug] [MainThread]: On master: COMMIT
15:32:46.366569 [debug] [MainThread]: Using postgres connection "master"
15:32:46.370094 [debug] [MainThread]: On master: COMMIT
15:32:46.374812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:32:46.378626 [debug] [MainThread]: On master: Close
15:32:46.384168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:32:46.388747 [info ] [MainThread]: 
15:32:46.502254 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
15:32:46.507318 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
15:32:46.512502 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
15:32:46.516379 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
15:32:46.520125 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
15:32:46.541151 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
15:32:46.554037 [debug] [Thread-1  ]: finished collecting timing info
15:32:46.557447 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
15:32:46.572727 [debug] [Thread-1  ]: finished collecting timing info
15:32:46.579270 [error] [Thread-1  ]: [31mUnhandled error while executing model.Marketing.orders_and_customers[0m
'list' object has no attribute 'find'
15:32:46.587289 [debug] [Thread-1  ]: 
15:32:46.602622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e9d07a0-48e2-4557-976f-856ef5e08554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cef60a0>]}
15:32:46.609078 [error] [Thread-1  ]: 1 of 2 ERROR creating table model testme_schema.orders_and_customers............ [[31mERROR[0m in 0.09s]
15:32:46.616207 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
15:32:46.625739 [debug] [Thread-1  ]: Began running node model.Marketing.email_list
15:32:46.631668 [info ] [Thread-1  ]: 2 of 2 SKIP relation testme_schema.email_list................................... [[33mSKIP[0m]
15:32:46.638618 [debug] [Thread-1  ]: Finished running node model.Marketing.email_list
15:32:46.647106 [debug] [MainThread]: Acquiring new postgres connection "master"
15:32:46.653707 [debug] [MainThread]: Using postgres connection "master"
15:32:46.658018 [debug] [MainThread]: On master: BEGIN
15:32:46.662977 [debug] [MainThread]: Opening a new connection, currently in state closed
15:32:46.746640 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
15:32:46.752874 [debug] [MainThread]: On master: COMMIT
15:32:46.757365 [debug] [MainThread]: Using postgres connection "master"
15:32:46.761719 [debug] [MainThread]: On master: COMMIT
15:32:46.767477 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:32:46.772592 [debug] [MainThread]: On master: Close
15:32:46.779203 [info ] [MainThread]: 
15:32:46.784293 [info ] [MainThread]: Finished running 2 table models in 2.64s.
15:32:46.789496 [debug] [MainThread]: Connection 'master' was properly closed.
15:32:46.795176 [debug] [MainThread]: Connection 'model.Marketing.orders_and_customers' was properly closed.
15:32:46.836753 [info ] [MainThread]: 
15:32:46.841448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:32:46.847239 [info ] [MainThread]: 
15:32:46.855256 [error] [MainThread]: [33m'list' object has no attribute 'find'[0m
15:32:46.862078 [info ] [MainThread]: 
15:32:46.866456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
15:32:46.872217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ce89b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ce89eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cef6ac0>]}


============================== 2022-03-29 15:33:54.287138 | 03ef2777-1289-426b-aa9f-091a3262c43b ==============================
15:33:54.287794 [info ] [MainThread]: Running with dbt=1.0.1
15:33:54.295880 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:33:54.300319 [debug] [MainThread]: Tracking: tracking
15:33:54.335406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b2190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b2220>]}
15:33:54.633515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:33:54.638274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:33:54.690801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ef2777-1289-426b-aa9f-091a3262c43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a30d0>]}
15:33:54.741522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ef2777-1289-426b-aa9f-091a3262c43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007707dc0>]}
15:33:54.747184 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
15:33:54.758376 [info ] [MainThread]: 
15:33:54.763890 [debug] [MainThread]: Acquiring new postgres connection "master"
15:33:54.777370 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
15:33:54.856514 [debug] [ThreadPool]: Using postgres connection "list_testme"
15:33:54.861500 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
15:33:54.867534 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:33:54.995720 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.13 seconds
15:33:56.715323 [debug] [ThreadPool]: On list_testme: Close
15:33:56.730262 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
15:33:56.778155 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:33:56.783427 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
15:33:56.787824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:33:56.877428 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
15:33:56.882868 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:33:56.888240 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
15:33:56.898777 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
15:33:56.911046 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
15:33:56.916466 [debug] [ThreadPool]: On list_testme_testme_schema: Close
15:33:56.948422 [debug] [MainThread]: Using postgres connection "master"
15:33:56.952937 [debug] [MainThread]: On master: BEGIN
15:33:56.957219 [debug] [MainThread]: Opening a new connection, currently in state init
15:33:57.042124 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
15:33:57.046874 [debug] [MainThread]: Using postgres connection "master"
15:33:57.050723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:33:57.062384 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
15:33:57.073760 [debug] [MainThread]: On master: ROLLBACK
15:33:57.078662 [debug] [MainThread]: Using postgres connection "master"
15:33:57.082464 [debug] [MainThread]: On master: BEGIN
15:33:57.088124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:33:57.092706 [debug] [MainThread]: On master: COMMIT
15:33:57.099336 [debug] [MainThread]: Using postgres connection "master"
15:33:57.103076 [debug] [MainThread]: On master: COMMIT
15:33:57.108893 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:33:57.113064 [debug] [MainThread]: On master: Close
15:33:57.117904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:33:57.121932 [info ] [MainThread]: 
15:33:57.143081 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
15:33:57.147889 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
15:33:57.154923 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
15:33:57.160179 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
15:33:57.164708 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
15:33:57.187977 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
15:33:57.198115 [debug] [Thread-1  ]: finished collecting timing info
15:33:57.202325 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
15:33:57.219945 [debug] [Thread-1  ]: finished collecting timing info
15:33:57.227091 [error] [Thread-1  ]: [31mUnhandled error while executing model.Marketing.orders_and_customers[0m
'list' object has no attribute 'find'
15:33:57.236221 [debug] [Thread-1  ]: 
15:33:57.254129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ef2777-1289-426b-aa9f-091a3262c43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ceee9d0>]}
15:33:57.261582 [error] [Thread-1  ]: 1 of 2 ERROR creating table model testme_schema.orders_and_customers............ [[31mERROR[0m in 0.10s]
15:33:57.269196 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
15:33:57.277887 [debug] [Thread-1  ]: Began running node model.Marketing.email_list
15:33:57.283054 [info ] [Thread-1  ]: 2 of 2 SKIP relation testme_schema.email_list................................... [[33mSKIP[0m]
15:33:57.289716 [debug] [Thread-1  ]: Finished running node model.Marketing.email_list
15:33:57.298458 [debug] [MainThread]: Acquiring new postgres connection "master"
15:33:57.304591 [debug] [MainThread]: Using postgres connection "master"
15:33:57.311018 [debug] [MainThread]: On master: BEGIN
15:33:57.316411 [debug] [MainThread]: Opening a new connection, currently in state closed
15:33:57.403594 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
15:33:57.412076 [debug] [MainThread]: On master: COMMIT
15:33:57.418472 [debug] [MainThread]: Using postgres connection "master"
15:33:57.423997 [debug] [MainThread]: On master: COMMIT
15:33:57.431886 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:33:57.437617 [debug] [MainThread]: On master: Close
15:33:57.444046 [info ] [MainThread]: 
15:33:57.449540 [info ] [MainThread]: Finished running 2 table models in 2.68s.
15:33:57.455387 [debug] [MainThread]: Connection 'master' was properly closed.
15:33:57.460493 [debug] [MainThread]: Connection 'model.Marketing.orders_and_customers' was properly closed.
15:33:57.502313 [info ] [MainThread]: 
15:33:57.506676 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:33:57.512909 [info ] [MainThread]: 
15:33:57.518272 [error] [MainThread]: [33m'list' object has no attribute 'find'[0m
15:33:57.525552 [info ] [MainThread]: 
15:33:57.531810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
15:33:57.541122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ce81fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cec3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ceee2b0>]}


============================== 2022-03-29 15:43:52.420489 | d2724582-5362-4387-915b-52851213f7e3 ==============================
15:43:52.425436 [info ] [MainThread]: Running with dbt=1.0.1
15:43:52.444352 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
15:43:52.455841 [debug] [MainThread]: Tracking: tracking
15:43:52.529640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076c6f40>]}
15:43:53.131155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:43:53.147356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:43:53.243978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2724582-5362-4387-915b-52851213f7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a90d0>]}
15:43:53.324413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2724582-5362-4387-915b-52851213f7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007729c70>]}
15:43:53.329807 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
15:43:53.347266 [info ] [MainThread]: 
15:43:53.359876 [debug] [MainThread]: Acquiring new postgres connection "master"
15:43:53.388670 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
15:43:53.614803 [debug] [ThreadPool]: Using postgres connection "list_testme"
15:43:53.620025 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
15:43:53.636584 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:43:53.902142 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.27 seconds
15:43:57.984725 [debug] [ThreadPool]: On list_testme: Close
15:43:58.019187 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
15:43:58.076305 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:43:58.084206 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
15:43:58.096249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:43:58.196288 [debug] [ThreadPool]: SQL status: BEGIN in 0.1 seconds
15:43:58.201226 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
15:43:58.216778 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
15:43:58.234798 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
15:43:58.247589 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
15:43:58.267411 [debug] [ThreadPool]: On list_testme_testme_schema: Close
15:43:58.415648 [debug] [MainThread]: Using postgres connection "master"
15:43:58.429366 [debug] [MainThread]: On master: BEGIN
15:43:58.446867 [debug] [MainThread]: Opening a new connection, currently in state init
15:43:58.718679 [debug] [MainThread]: SQL status: BEGIN in 0.27 seconds
15:43:58.729308 [debug] [MainThread]: Using postgres connection "master"
15:43:58.740406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
15:43:58.795387 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
15:43:58.823109 [debug] [MainThread]: On master: ROLLBACK
15:43:58.833125 [debug] [MainThread]: Using postgres connection "master"
15:43:58.840221 [debug] [MainThread]: On master: BEGIN
15:43:58.854268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
15:43:58.859253 [debug] [MainThread]: On master: COMMIT
15:43:58.867256 [debug] [MainThread]: Using postgres connection "master"
15:43:58.871835 [debug] [MainThread]: On master: COMMIT
15:43:58.885051 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:43:58.891540 [debug] [MainThread]: On master: Close
15:43:58.898450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:43:58.905842 [info ] [MainThread]: 
15:43:59.181650 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
15:43:59.188652 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
15:43:59.194805 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
15:43:59.205787 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
15:43:59.210205 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
15:43:59.272535 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
15:43:59.297309 [debug] [Thread-1  ]: finished collecting timing info
15:43:59.302777 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
15:44:04.515816 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
15:44:04.565923 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:04.571957 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
15:44:04.588689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:04.806364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.22 seconds
15:44:04.815243 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:04.835838 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
15:44:04.867617 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.02 seconds
15:44:07.291728 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:07.307271 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
15:44:07.323804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:44:07.368487 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:07.375809 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
15:44:07.390767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:44:07.499982 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
15:44:07.518649 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:07.525011 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
15:44:07.533810 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:44:07.629814 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
15:44:07.636985 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
15:44:07.656973 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
15:44:07.691581 [debug] [Thread-1  ]: finished collecting timing info
15:44:07.708883 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
15:44:07.717752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2724582-5362-4387-915b-52851213f7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038bcc070>]}
15:44:07.737500 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 396[0m in 8.52s]
15:44:07.749408 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
15:44:07.782889 [debug] [Thread-1  ]: Began running node model.Marketing.email_list
15:44:07.790895 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.email_list............................... [RUN]
15:44:07.798011 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.email_list"
15:44:07.815680 [debug] [Thread-1  ]: Began compiling node model.Marketing.email_list
15:44:07.829603 [debug] [Thread-1  ]: Compiling model.Marketing.email_list
15:44:07.906018 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.email_list"
15:44:07.932857 [debug] [Thread-1  ]: finished collecting timing info
15:44:07.938902 [debug] [Thread-1  ]: Began executing node model.Marketing.email_list
15:44:09.089205 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.email_list"
15:44:09.110681 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:09.116240 [debug] [Thread-1  ]: On model.Marketing.email_list: BEGIN
15:44:09.122958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:09.222697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.1 seconds
15:44:09.230636 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:09.238264 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */


  create  table "testme"."testme_schema"."email_list__dbt_tmp"
  as (
    

-- FIXME: support views
-- Use the `ref` function to select from other models

select email
from "testme"."testme_schema"."orders_and_customers"
  );
15:44:09.260620 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
15:44:10.076811 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:10.083868 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */
alter table "testme"."testme_schema"."email_list" rename to "email_list__dbt_backup"
15:44:10.093700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:44:10.117706 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:10.124059 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */
alter table "testme"."testme_schema"."email_list__dbt_tmp" rename to "email_list"
15:44:10.133985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
15:44:10.152939 [debug] [Thread-1  ]: On model.Marketing.email_list: COMMIT
15:44:10.159982 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:10.167843 [debug] [Thread-1  ]: On model.Marketing.email_list: COMMIT
15:44:10.184597 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
15:44:10.200274 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.email_list"
15:44:10.207947 [debug] [Thread-1  ]: On model.Marketing.email_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.email_list"} */
drop table if exists "testme"."testme_schema"."email_list__dbt_backup" cascade
15:44:10.219474 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
15:44:11.706796 [debug] [Thread-1  ]: finished collecting timing info
15:44:11.721021 [debug] [Thread-1  ]: On model.Marketing.email_list: Close
15:44:11.740100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2724582-5362-4387-915b-52851213f7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038bf8dc0>]}
15:44:11.750401 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.email_list.......................... [[32mSELECT 396[0m in 3.94s]
15:44:11.769606 [debug] [Thread-1  ]: Finished running node model.Marketing.email_list
15:44:11.782366 [debug] [MainThread]: Acquiring new postgres connection "master"
15:44:11.789672 [debug] [MainThread]: Using postgres connection "master"
15:44:11.796245 [debug] [MainThread]: On master: BEGIN
15:44:11.801640 [debug] [MainThread]: Opening a new connection, currently in state closed
15:44:11.896045 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
15:44:11.903644 [debug] [MainThread]: On master: COMMIT
15:44:11.908602 [debug] [MainThread]: Using postgres connection "master"
15:44:11.915032 [debug] [MainThread]: On master: COMMIT
15:44:11.923390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
15:44:11.929855 [debug] [MainThread]: On master: Close
15:44:11.938585 [info ] [MainThread]: 
15:44:11.944705 [info ] [MainThread]: Finished running 2 table models in 18.58s.
15:44:11.950556 [debug] [MainThread]: Connection 'master' was properly closed.
15:44:11.955946 [debug] [MainThread]: Connection 'model.Marketing.email_list' was properly closed.
15:44:12.000711 [info ] [MainThread]: 
15:44:12.007266 [info ] [MainThread]: [32mCompleted successfully[0m
15:44:12.017901 [info ] [MainThread]: 
15:44:12.023616 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:44:12.029915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40100cf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40100cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ced0130>]}


============================== 2022-03-30 07:54:24.248557 | 47e38d8d-1412-4206-bcf8-a0dc7e6f593c ==============================
07:54:24.249147 [info ] [MainThread]: Running with dbt=1.0.1
07:54:24.268846 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:54:24.275191 [debug] [MainThread]: Tracking: tracking
07:54:24.430266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076d3910>]}
07:54:24.774596 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
07:54:24.781078 [debug] [MainThread]: Partial parsing: added file: Marketing://models/example/contact_list.sql
07:54:24.791629 [debug] [MainThread]: Partial parsing: update schema file: Marketing://models/example/schema.yml
07:54:24.796764 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models/example/email_list.sql
07:54:24.803813 [debug] [MainThread]: Partial parsing: updated file: Marketing://models/example/orders_and_customers.sql
07:54:25.079090 [debug] [MainThread]: 1699: static parser successfully parsed example/contact_list.sql
07:54:25.263610 [debug] [MainThread]: 1699: static parser successfully parsed example/orders_and_customers.sql
07:54:25.683853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e38d8d-1412-4206-bcf8-a0dc7e6f593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007785880>]}
07:54:25.887163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e38d8d-1412-4206-bcf8-a0dc7e6f593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007636220>]}
07:54:25.894142 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
07:54:25.909992 [info ] [MainThread]: 
07:54:25.924182 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:25.954710 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
07:54:26.067005 [debug] [ThreadPool]: Using postgres connection "list_testme"
07:54:26.072218 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
07:54:26.077423 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:54:26.263625 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.19 seconds
07:54:29.192163 [debug] [ThreadPool]: On list_testme: Close
07:54:29.214159 [debug] [ThreadPool]: Acquiring new postgres connection "create_testme_testme_schema"
07:54:29.228230 [debug] [ThreadPool]: Acquiring new postgres connection "create_testme_testme_schema"
07:54:29.232794 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='testme', schema='testme_schema', identifier=None)"
07:54:29.325247 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
07:54:29.338467 [debug] [ThreadPool]: On create_testme_testme_schema: BEGIN
07:54:29.353597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:54:29.515940 [debug] [ThreadPool]: SQL status: BEGIN in 0.16 seconds
07:54:29.535981 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
07:54:29.541019 [debug] [ThreadPool]: On create_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "create_testme_testme_schema"} */
create schema if not exists "testme_schema"
07:54:29.547772 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
07:54:30.218907 [debug] [ThreadPool]: On create_testme_testme_schema: COMMIT
07:54:30.232394 [debug] [ThreadPool]: Using postgres connection "create_testme_testme_schema"
07:54:30.239469 [debug] [ThreadPool]: On create_testme_testme_schema: COMMIT
07:54:30.263352 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
07:54:30.277162 [debug] [ThreadPool]: On create_testme_testme_schema: Close
07:54:30.300591 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
07:54:30.693780 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
07:54:30.710503 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
07:54:30.717490 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:54:30.984802 [debug] [ThreadPool]: SQL status: BEGIN in 0.27 seconds
07:54:31.000764 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
07:54:31.006985 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
07:54:31.021931 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
07:54:31.038795 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
07:54:31.062253 [debug] [ThreadPool]: On list_testme_testme_schema: Close
07:54:31.106894 [debug] [MainThread]: Using postgres connection "master"
07:54:31.125257 [debug] [MainThread]: On master: BEGIN
07:54:31.129943 [debug] [MainThread]: Opening a new connection, currently in state init
07:54:31.235931 [debug] [MainThread]: SQL status: BEGIN in 0.11 seconds
07:54:31.242513 [debug] [MainThread]: Using postgres connection "master"
07:54:31.249233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:54:31.282951 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
07:54:31.296998 [debug] [MainThread]: On master: ROLLBACK
07:54:31.316996 [debug] [MainThread]: Using postgres connection "master"
07:54:31.323126 [debug] [MainThread]: On master: BEGIN
07:54:31.341578 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
07:54:31.347838 [debug] [MainThread]: On master: COMMIT
07:54:31.353521 [debug] [MainThread]: Using postgres connection "master"
07:54:31.365498 [debug] [MainThread]: On master: COMMIT
07:54:31.374123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:31.385473 [debug] [MainThread]: On master: Close
07:54:31.400167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:54:31.406119 [info ] [MainThread]: 
07:54:31.739599 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
07:54:31.746729 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
07:54:31.762051 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
07:54:31.775576 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
07:54:31.788969 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
07:54:31.859138 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
07:54:31.896645 [debug] [Thread-1  ]: finished collecting timing info
07:54:31.904178 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
07:54:35.073492 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
07:54:35.088790 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
07:54:35.094649 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
07:54:35.100924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:54:35.191254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
07:54:35.196725 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
07:54:35.202485 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
07:54:35.215474 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
07:54:36.205759 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
07:54:36.211735 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
07:54:36.220389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
07:54:36.314838 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
07:54:36.320556 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
07:54:36.325482 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
07:54:36.332736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
07:54:36.369539 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
07:54:36.376408 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
07:54:36.384540 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
07:54:36.403014 [debug] [Thread-1  ]: finished collecting timing info
07:54:36.407647 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
07:54:36.414477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e38d8d-1412-4206-bcf8-a0dc7e6f593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40595123d0>]}
07:54:36.421898 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 396[0m in 4.65s]
07:54:36.431184 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
07:54:36.440725 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
07:54:36.446493 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
07:54:36.452494 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
07:54:36.456829 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
07:54:36.461754 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
07:54:36.482646 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
07:54:36.491992 [debug] [Thread-1  ]: finished collecting timing info
07:54:36.496260 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
07:54:37.493827 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
07:54:37.505417 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
07:54:37.510538 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
07:54:37.515566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:54:37.601816 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
07:54:37.606684 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
07:54:37.610816 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
07:54:37.621260 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.0 seconds
07:54:38.232707 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
07:54:38.237708 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
07:54:38.245145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
07:54:38.260418 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
07:54:38.265649 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
07:54:38.269855 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
07:54:38.277195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
07:54:38.289809 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
07:54:38.294626 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
07:54:38.302230 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
07:54:39.905068 [debug] [Thread-1  ]: finished collecting timing info
07:54:39.910570 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
07:54:39.918851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e38d8d-1412-4206-bcf8-a0dc7e6f593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40595ee670>]}
07:54:39.925190 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 396[0m in 3.47s]
07:54:39.931161 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
07:54:39.939332 [debug] [MainThread]: Acquiring new postgres connection "master"
07:54:39.944587 [debug] [MainThread]: Using postgres connection "master"
07:54:39.949840 [debug] [MainThread]: On master: BEGIN
07:54:39.954031 [debug] [MainThread]: Opening a new connection, currently in state closed
07:54:40.049125 [debug] [MainThread]: SQL status: BEGIN in 0.1 seconds
07:54:40.054634 [debug] [MainThread]: On master: COMMIT
07:54:40.058526 [debug] [MainThread]: Using postgres connection "master"
07:54:40.062878 [debug] [MainThread]: On master: COMMIT
07:54:40.067969 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
07:54:40.072056 [debug] [MainThread]: On master: Close
07:54:40.077677 [info ] [MainThread]: 
07:54:40.082560 [info ] [MainThread]: Finished running 2 table models in 14.15s.
07:54:40.086951 [debug] [MainThread]: Connection 'master' was properly closed.
07:54:40.090822 [debug] [MainThread]: Connection 'create_testme_testme_schema' was properly closed.
07:54:40.094735 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
07:54:40.132806 [info ] [MainThread]: 
07:54:40.136782 [info ] [MainThread]: [32mCompleted successfully[0m
07:54:40.141854 [info ] [MainThread]: 
07:54:40.145858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
07:54:40.165050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x400764ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x405960b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40596200d0>]}


============================== 2022-03-30 08:03:24.781540 | 333c4dc7-49bd-416e-8a5d-0ba846ff2630 ==============================
08:03:24.782107 [info ] [MainThread]: Running with dbt=1.0.1
08:03:24.789181 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:03:24.793562 [debug] [MainThread]: Tracking: tracking
08:03:24.824120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b13a0>]}
08:03:25.067149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:03:25.071604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:03:25.118100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '333c4dc7-49bd-416e-8a5d-0ba846ff2630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a30d0>]}
08:03:25.165417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '333c4dc7-49bd-416e-8a5d-0ba846ff2630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007772070>]}
08:03:25.170429 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:03:25.180316 [info ] [MainThread]: 
08:03:25.185593 [debug] [MainThread]: Acquiring new postgres connection "master"
08:03:25.196611 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:03:25.268504 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:03:25.272639 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:03:25.276265 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:03:25.387416 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.11 seconds
08:03:26.842083 [debug] [ThreadPool]: On list_testme: Close
08:03:26.853759 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:03:26.893722 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:03:26.897348 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:03:26.901319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:03:26.984736 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
08:03:26.989115 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:03:26.992760 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:03:26.999501 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
08:03:27.009543 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:03:27.014199 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:03:27.044401 [debug] [MainThread]: Using postgres connection "master"
08:03:27.048177 [debug] [MainThread]: On master: BEGIN
08:03:27.051780 [debug] [MainThread]: Opening a new connection, currently in state init
08:03:27.131531 [debug] [MainThread]: SQL status: BEGIN in 0.08 seconds
08:03:27.135990 [debug] [MainThread]: Using postgres connection "master"
08:03:27.139815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:03:27.152138 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
08:03:27.162594 [debug] [MainThread]: On master: ROLLBACK
08:03:27.167348 [debug] [MainThread]: Using postgres connection "master"
08:03:27.170481 [debug] [MainThread]: On master: BEGIN
08:03:27.177088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:03:27.180275 [debug] [MainThread]: On master: COMMIT
08:03:27.184122 [debug] [MainThread]: Using postgres connection "master"
08:03:27.187808 [debug] [MainThread]: On master: COMMIT
08:03:27.192365 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:03:27.195761 [debug] [MainThread]: On master: Close
08:03:27.200006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:03:27.204403 [info ] [MainThread]: 
08:03:27.221931 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:03:27.226969 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:03:27.232020 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:03:27.235798 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:03:27.239162 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:03:27.259850 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:03:27.268675 [debug] [Thread-1  ]: finished collecting timing info
08:03:27.272102 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:03:29.854938 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:03:29.868153 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:03:29.873458 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:03:29.878276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:03:29.959385 [debug] [Thread-1  ]: SQL status: BEGIN in 0.08 seconds
08:03:29.964744 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:03:29.970374 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:03:29.982716 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:03:30.274166 [debug] [Thread-1  ]: finished collecting timing info
08:03:30.280606 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: ROLLBACK
08:03:30.286026 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:03:30.291830 [error] [Thread-1  ]: [31mUnhandled error while executing model.Marketing.orders_and_customers[0m
column "date" does not exist
LINE 1: select count(distinct Date) Date_levels,sum(num_nulls(Date))...
                              ^
HINT:  Perhaps you meant to reference the column "orders.Date".
08:03:30.300831 [debug] [Thread-1  ]: 
08:03:30.333075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '333c4dc7-49bd-416e-8a5d-0ba846ff2630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40366fc040>]}
08:03:30.339712 [error] [Thread-1  ]: 1 of 2 ERROR creating table model testme_schema.orders_and_customers............ [[31mERROR[0m in 3.10s]
08:03:30.347714 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:03:30.356931 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:03:30.363116 [info ] [Thread-1  ]: 2 of 2 SKIP relation testme_schema.contact_list................................. [[33mSKIP[0m]
08:03:30.369906 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:03:30.380052 [debug] [MainThread]: Acquiring new postgres connection "master"
08:03:30.387157 [debug] [MainThread]: Using postgres connection "master"
08:03:30.393034 [debug] [MainThread]: On master: BEGIN
08:03:30.398339 [debug] [MainThread]: Opening a new connection, currently in state closed
08:03:30.483592 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:03:30.488348 [debug] [MainThread]: On master: COMMIT
08:03:30.492927 [debug] [MainThread]: Using postgres connection "master"
08:03:30.498531 [debug] [MainThread]: On master: COMMIT
08:03:30.505120 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:03:30.510521 [debug] [MainThread]: On master: Close
08:03:30.516755 [info ] [MainThread]: 
08:03:30.521119 [info ] [MainThread]: Finished running 2 table models in 5.33s.
08:03:30.525014 [debug] [MainThread]: Connection 'master' was properly closed.
08:03:30.529571 [debug] [MainThread]: Connection 'model.Marketing.orders_and_customers' was properly closed.
08:03:30.566196 [info ] [MainThread]: 
08:03:30.570270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:03:30.576496 [info ] [MainThread]: 
08:03:30.580698 [error] [MainThread]: [33mcolumn "date" does not exist[0m
08:03:30.586497 [error] [MainThread]: LINE 1: select count(distinct Date) Date_levels,sum(num_nulls(Date))...
08:03:30.592025 [error] [MainThread]:                               ^
08:03:30.596929 [error] [MainThread]: HINT:  Perhaps you meant to reference the column "orders.Date".
08:03:30.601466 [error] [MainThread]: 
08:03:30.606203 [info ] [MainThread]: 
08:03:30.611559 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
08:03:30.616555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40100c4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cec6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401ceed5b0>]}


============================== 2022-03-30 08:06:33.227634 | 0fd6668e-0612-4533-8fa2-da32673c3346 ==============================
08:06:33.228250 [info ] [MainThread]: Running with dbt=1.0.1
08:06:33.238878 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:06:33.243681 [debug] [MainThread]: Tracking: tracking
08:06:33.281828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b7040>]}
08:06:33.563887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:06:33.568532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:06:33.617604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fd6668e-0612-4533-8fa2-da32673c3346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a3af0>]}
08:06:33.674901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fd6668e-0612-4533-8fa2-da32673c3346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007708b80>]}
08:06:33.679899 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:06:33.689606 [info ] [MainThread]: 
08:06:33.695106 [debug] [MainThread]: Acquiring new postgres connection "master"
08:06:33.705568 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:06:33.782021 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:06:33.786252 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:06:33.790166 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:06:33.911321 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.12 seconds
08:06:35.612274 [debug] [ThreadPool]: On list_testme: Close
08:06:35.624939 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:06:35.678186 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:06:35.683599 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:06:35.687611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:06:35.778887 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
08:06:35.783760 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:06:35.787282 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:06:35.795908 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
08:06:35.808794 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:06:35.814689 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:06:35.849423 [debug] [MainThread]: Using postgres connection "master"
08:06:35.853587 [debug] [MainThread]: On master: BEGIN
08:06:35.857188 [debug] [MainThread]: Opening a new connection, currently in state init
08:06:35.944527 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:06:35.948923 [debug] [MainThread]: Using postgres connection "master"
08:06:35.952222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:06:35.964208 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
08:06:35.974650 [debug] [MainThread]: On master: ROLLBACK
08:06:35.979312 [debug] [MainThread]: Using postgres connection "master"
08:06:35.982483 [debug] [MainThread]: On master: BEGIN
08:06:35.988411 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:06:35.992112 [debug] [MainThread]: On master: COMMIT
08:06:35.995235 [debug] [MainThread]: Using postgres connection "master"
08:06:35.998499 [debug] [MainThread]: On master: COMMIT
08:06:36.003835 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:06:36.007726 [debug] [MainThread]: On master: Close
08:06:36.012549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:06:36.016390 [info ] [MainThread]: 
08:06:36.035181 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:06:36.040126 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:06:36.044739 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:06:36.049118 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:06:36.052322 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:06:36.077471 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:06:36.089323 [debug] [Thread-1  ]: finished collecting timing info
08:06:36.093812 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:06:38.540165 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:06:38.552210 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:38.556470 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:06:38.560667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:06:38.648670 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
08:06:38.653948 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:38.658438 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:06:38.670801 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
08:06:39.912164 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:39.918323 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
08:06:39.926097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:06:39.945161 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:39.950111 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
08:06:39.956885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:06:40.056288 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:06:40.062492 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:40.068723 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:06:40.078199 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:06:40.122488 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:06:40.128588 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
08:06:40.140217 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:06:40.159327 [debug] [Thread-1  ]: finished collecting timing info
08:06:40.164910 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:06:40.171591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fd6668e-0612-4533-8fa2-da32673c3346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038408c10>]}
08:06:40.178454 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 396[0m in 4.13s]
08:06:40.185553 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:06:40.193343 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:06:40.198412 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
08:06:40.203915 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
08:06:40.208760 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
08:06:40.213207 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
08:06:40.232747 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
08:06:40.242354 [debug] [Thread-1  ]: finished collecting timing info
08:06:40.247018 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
08:06:41.245778 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
08:06:41.256398 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:41.260897 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
08:06:41.265228 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:06:41.350144 [debug] [Thread-1  ]: SQL status: BEGIN in 0.08 seconds
08:06:41.356158 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:41.360544 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
08:06:41.371159 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.0 seconds
08:06:42.173882 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:42.179607 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list" rename to "contact_list__dbt_backup"
08:06:42.186478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:06:42.206182 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:42.211126 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
08:06:42.217511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:06:42.232202 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:06:42.236618 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:42.241101 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:06:42.247763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:06:42.260303 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:06:42.264876 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
08:06:42.272658 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:06:43.431920 [debug] [Thread-1  ]: finished collecting timing info
08:06:43.437834 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
08:06:43.444218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fd6668e-0612-4533-8fa2-da32673c3346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x403841a8b0>]}
08:06:43.450828 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 396[0m in 3.24s]
08:06:43.456903 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:06:43.465884 [debug] [MainThread]: Acquiring new postgres connection "master"
08:06:43.470794 [debug] [MainThread]: Using postgres connection "master"
08:06:43.475381 [debug] [MainThread]: On master: BEGIN
08:06:43.479260 [debug] [MainThread]: Opening a new connection, currently in state closed
08:06:43.564508 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:06:43.569469 [debug] [MainThread]: On master: COMMIT
08:06:43.573933 [debug] [MainThread]: Using postgres connection "master"
08:06:43.578377 [debug] [MainThread]: On master: COMMIT
08:06:43.583503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:06:43.587613 [debug] [MainThread]: On master: Close
08:06:43.592868 [info ] [MainThread]: 
08:06:43.597482 [info ] [MainThread]: Finished running 2 table models in 9.90s.
08:06:43.602152 [debug] [MainThread]: Connection 'master' was properly closed.
08:06:43.606375 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
08:06:43.642496 [info ] [MainThread]: 
08:06:43.646839 [info ] [MainThread]: [32mCompleted successfully[0m
08:06:43.652032 [info ] [MainThread]: 
08:06:43.655549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:06:43.660596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038408c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cebaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cee3940>]}


============================== 2022-03-30 08:09:35.533563 | 077dae33-38f5-4405-85b5-83bf738f342a ==============================
08:09:35.534444 [info ] [MainThread]: Running with dbt=1.0.1
08:09:35.544300 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:09:35.552146 [debug] [MainThread]: Tracking: tracking
08:09:35.597789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076b6100>]}
08:09:36.033108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:09:36.057302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:09:36.217505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '077dae33-38f5-4405-85b5-83bf738f342a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a40d0>]}
08:09:36.306131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '077dae33-38f5-4405-85b5-83bf738f342a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007702ca0>]}
08:09:36.312026 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:09:36.329683 [info ] [MainThread]: 
08:09:36.336771 [debug] [MainThread]: Acquiring new postgres connection "master"
08:09:36.378071 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:09:36.520553 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:09:36.526457 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:09:36.541628 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:09:36.746851 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.2 seconds
08:09:39.867618 [debug] [ThreadPool]: On list_testme: Close
08:09:39.904600 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:09:40.046609 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:09:40.058753 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:09:40.068028 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:09:40.228072 [debug] [ThreadPool]: SQL status: BEGIN in 0.16 seconds
08:09:40.234557 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:09:40.248622 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:09:40.272671 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.02 seconds
08:09:40.300248 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:09:40.323731 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:09:40.370501 [debug] [MainThread]: Using postgres connection "master"
08:09:40.396540 [debug] [MainThread]: On master: BEGIN
08:09:40.400697 [debug] [MainThread]: Opening a new connection, currently in state init
08:09:40.534301 [debug] [MainThread]: SQL status: BEGIN in 0.13 seconds
08:09:40.540290 [debug] [MainThread]: Using postgres connection "master"
08:09:40.544066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:09:40.570942 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:09:40.583383 [debug] [MainThread]: On master: ROLLBACK
08:09:40.589583 [debug] [MainThread]: Using postgres connection "master"
08:09:40.600775 [debug] [MainThread]: On master: BEGIN
08:09:40.610320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:09:40.615957 [debug] [MainThread]: On master: COMMIT
08:09:40.619711 [debug] [MainThread]: Using postgres connection "master"
08:09:40.624124 [debug] [MainThread]: On master: COMMIT
08:09:40.630805 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:09:40.635548 [debug] [MainThread]: On master: Close
08:09:40.642276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:09:40.652752 [info ] [MainThread]: 
08:09:40.696329 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:09:40.704278 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:09:40.720721 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:09:40.736126 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:09:40.746944 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:09:40.776875 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:09:40.794228 [debug] [Thread-1  ]: finished collecting timing info
08:09:40.800974 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:09:44.350125 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:09:44.391063 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:44.403079 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:09:44.410138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:09:44.561715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.15 seconds
08:09:44.575150 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:44.586363 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:09:44.611861 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:09:46.599773 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:46.609767 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
08:09:46.636766 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
08:09:46.670614 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:46.685593 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
08:09:46.706254 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:09:46.875552 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:09:46.883581 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:46.889667 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:09:46.899549 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:09:46.966152 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:09:46.972506 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
08:09:46.987264 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:09:47.016194 [debug] [Thread-1  ]: finished collecting timing info
08:09:47.028494 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:09:47.041323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077dae33-38f5-4405-85b5-83bf738f342a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038ac6280>]}
08:09:47.052006 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 386[0m in 6.32s]
08:09:47.076079 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:09:47.090360 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:09:47.101546 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
08:09:47.115958 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
08:09:47.123902 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
08:09:47.132601 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
08:09:47.160896 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
08:09:47.174709 [debug] [Thread-1  ]: finished collecting timing info
08:09:47.180672 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
08:09:48.612230 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
08:09:48.693972 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:48.700695 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
08:09:48.706643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:09:48.813551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
08:09:48.821323 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:48.831044 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
08:09:48.852706 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:09:49.749341 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:49.765970 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list" rename to "contact_list__dbt_backup"
08:09:49.775412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:09:49.800408 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:49.808880 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
08:09:49.819757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:09:49.841224 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:09:49.848041 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:49.853455 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:09:49.861105 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:09:49.879644 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:09:49.885713 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
08:09:49.898811 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:09:51.225112 [debug] [Thread-1  ]: finished collecting timing info
08:09:51.235619 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
08:09:51.246750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077dae33-38f5-4405-85b5-83bf738f342a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038419d00>]}
08:09:51.256642 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 386[0m in 4.13s]
08:09:51.266478 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:09:51.278590 [debug] [MainThread]: Acquiring new postgres connection "master"
08:09:51.301899 [debug] [MainThread]: Using postgres connection "master"
08:09:51.308920 [debug] [MainThread]: On master: BEGIN
08:09:51.314293 [debug] [MainThread]: Opening a new connection, currently in state closed
08:09:51.408997 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:09:51.414575 [debug] [MainThread]: On master: COMMIT
08:09:51.427604 [debug] [MainThread]: Using postgres connection "master"
08:09:51.435114 [debug] [MainThread]: On master: COMMIT
08:09:51.446844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:09:51.453283 [debug] [MainThread]: On master: Close
08:09:51.463436 [info ] [MainThread]: 
08:09:51.469919 [info ] [MainThread]: Finished running 2 table models in 15.13s.
08:09:51.476791 [debug] [MainThread]: Connection 'master' was properly closed.
08:09:51.491606 [debug] [MainThread]: Connection 'list_testme' was properly closed.
08:09:51.497106 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
08:09:51.553612 [info ] [MainThread]: 
08:09:51.562570 [info ] [MainThread]: [32mCompleted successfully[0m
08:09:51.572965 [info ] [MainThread]: 
08:09:51.579587 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:09:51.586249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007702970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cec7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cee3f10>]}


============================== 2022-03-30 08:26:35.958466 | eb40e550-d2ed-4b98-a94c-b6c8c8bbba77 ==============================
08:26:35.959116 [info ] [MainThread]: Running with dbt=1.0.1
08:26:35.983060 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:26:35.990012 [debug] [MainThread]: Tracking: tracking
08:26:36.071013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8f40>]}
08:26:36.620718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:26:36.625390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:26:36.729531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb40e550-d2ed-4b98-a94c-b6c8c8bbba77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a4a90>]}
08:26:36.853172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb40e550-d2ed-4b98-a94c-b6c8c8bbba77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076f9b20>]}
08:26:36.874915 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:26:36.900413 [info ] [MainThread]: 
08:26:36.907415 [debug] [MainThread]: Acquiring new postgres connection "master"
08:26:36.957667 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:26:37.206173 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:26:37.224316 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:26:37.229112 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:26:37.499462 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.27 seconds
08:26:40.708551 [debug] [ThreadPool]: On list_testme: Close
08:26:40.746411 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:26:40.820510 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:26:40.825523 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:26:40.838904 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:26:40.944896 [debug] [ThreadPool]: SQL status: BEGIN in 0.11 seconds
08:26:40.950415 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:26:40.954191 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:26:40.967345 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
08:26:40.981487 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:26:41.003870 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:26:41.108749 [debug] [MainThread]: Using postgres connection "master"
08:26:41.116856 [debug] [MainThread]: On master: BEGIN
08:26:41.128871 [debug] [MainThread]: Opening a new connection, currently in state init
08:26:41.341429 [debug] [MainThread]: SQL status: BEGIN in 0.21 seconds
08:26:41.348403 [debug] [MainThread]: Using postgres connection "master"
08:26:41.352804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:26:41.388188 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
08:26:41.415732 [debug] [MainThread]: On master: ROLLBACK
08:26:41.427223 [debug] [MainThread]: Using postgres connection "master"
08:26:41.433047 [debug] [MainThread]: On master: BEGIN
08:26:41.441872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:26:41.470961 [debug] [MainThread]: On master: COMMIT
08:26:41.478269 [debug] [MainThread]: Using postgres connection "master"
08:26:41.488567 [debug] [MainThread]: On master: COMMIT
08:26:41.499337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:26:41.503994 [debug] [MainThread]: On master: Close
08:26:41.511404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:26:41.526655 [info ] [MainThread]: 
08:26:41.568197 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:26:41.574358 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:26:41.579707 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:26:41.583980 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:26:41.599221 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:26:41.641880 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:26:41.657570 [debug] [Thread-1  ]: finished collecting timing info
08:26:41.661289 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:26:44.085842 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:26:44.098849 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:44.103438 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:26:44.107196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:26:44.194347 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
08:26:44.200306 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:44.205762 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:26:44.218880 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:26:45.414356 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:45.420950 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
08:26:45.429808 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:26:45.450577 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:45.455430 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
08:26:45.463371 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:26:45.555294 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:26:45.561543 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:45.566127 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:26:45.573918 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:26:45.614854 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:26:45.620736 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
08:26:45.631963 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
08:26:45.650769 [debug] [Thread-1  ]: finished collecting timing info
08:26:45.656310 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:26:45.663718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb40e550-d2ed-4b98-a94c-b6c8c8bbba77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038406bb0>]}
08:26:45.670500 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 386[0m in 4.08s]
08:26:45.679889 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:26:45.689310 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:26:45.694559 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
08:26:45.700892 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
08:26:45.706513 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
08:26:45.710400 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
08:26:45.730467 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
08:26:45.741824 [debug] [Thread-1  ]: finished collecting timing info
08:26:45.747321 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
08:26:46.762491 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
08:26:46.775213 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:46.779785 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
08:26:46.783566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:26:46.869876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
08:26:46.876448 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:46.881969 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
08:26:46.894792 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:26:47.692990 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:47.699736 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list" rename to "contact_list__dbt_backup"
08:26:47.707677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:26:47.726006 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:47.731267 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
08:26:47.738142 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:26:47.753089 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:26:47.757491 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:47.763124 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:26:47.770354 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:26:47.788578 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:26:47.793571 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
08:26:47.801999 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:26:48.958704 [debug] [Thread-1  ]: finished collecting timing info
08:26:48.964458 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
08:26:48.972270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb40e550-d2ed-4b98-a94c-b6c8c8bbba77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038419850>]}
08:26:48.980281 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 386[0m in 3.27s]
08:26:48.989403 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:26:48.998472 [debug] [MainThread]: Acquiring new postgres connection "master"
08:26:49.003197 [debug] [MainThread]: Using postgres connection "master"
08:26:49.009499 [debug] [MainThread]: On master: BEGIN
08:26:49.013552 [debug] [MainThread]: Opening a new connection, currently in state closed
08:26:49.099952 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:26:49.105823 [debug] [MainThread]: On master: COMMIT
08:26:49.109966 [debug] [MainThread]: Using postgres connection "master"
08:26:49.114142 [debug] [MainThread]: On master: COMMIT
08:26:49.119583 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:26:49.124232 [debug] [MainThread]: On master: Close
08:26:49.130184 [info ] [MainThread]: 
08:26:49.134405 [info ] [MainThread]: Finished running 2 table models in 12.22s.
08:26:49.138966 [debug] [MainThread]: Connection 'master' was properly closed.
08:26:49.143586 [debug] [MainThread]: Connection 'list_testme' was properly closed.
08:26:49.148762 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
08:26:49.186774 [info ] [MainThread]: 
08:26:49.190574 [info ] [MainThread]: [32mCompleted successfully[0m
08:26:49.197932 [info ] [MainThread]: 
08:26:49.201720 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:26:49.206847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038419850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076f97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cee4940>]}


============================== 2022-03-30 08:33:49.355603 | d2f67ad3-29d0-4f55-bff1-958ccc403d13 ==============================
08:33:49.356174 [info ] [MainThread]: Running with dbt=1.0.1
08:33:49.364431 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:33:49.368892 [debug] [MainThread]: Tracking: tracking
08:33:49.400605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a8f40>]}
08:33:49.666661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:33:49.671213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:33:49.722659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f67ad3-29d0-4f55-bff1-958ccc403d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a1a90>]}
08:33:49.771799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f67ad3-29d0-4f55-bff1-958ccc403d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007701b20>]}
08:33:49.777365 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:33:49.786972 [info ] [MainThread]: 
08:33:49.791929 [debug] [MainThread]: Acquiring new postgres connection "master"
08:33:49.802511 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:33:49.879039 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:33:49.884735 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:33:49.889148 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:33:50.006232 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.12 seconds
08:33:51.645400 [debug] [ThreadPool]: On list_testme: Close
08:33:51.658141 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:33:51.703873 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:33:51.708296 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:33:51.711482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:33:51.798622 [debug] [ThreadPool]: SQL status: BEGIN in 0.09 seconds
08:33:51.803624 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:33:51.807001 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:33:51.814203 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
08:33:51.825990 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:33:51.830841 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:33:51.863953 [debug] [MainThread]: Using postgres connection "master"
08:33:51.868094 [debug] [MainThread]: On master: BEGIN
08:33:51.872215 [debug] [MainThread]: Opening a new connection, currently in state init
08:33:51.957739 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:33:51.961682 [debug] [MainThread]: Using postgres connection "master"
08:33:51.965150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:33:51.978311 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:33:51.988539 [debug] [MainThread]: On master: ROLLBACK
08:33:51.993291 [debug] [MainThread]: Using postgres connection "master"
08:33:51.997375 [debug] [MainThread]: On master: BEGIN
08:33:52.005259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:33:52.008924 [debug] [MainThread]: On master: COMMIT
08:33:52.012600 [debug] [MainThread]: Using postgres connection "master"
08:33:52.015778 [debug] [MainThread]: On master: COMMIT
08:33:52.037204 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:33:52.040456 [debug] [MainThread]: On master: Close
08:33:52.045222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:33:52.050168 [info ] [MainThread]: 
08:33:52.069674 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:33:52.075147 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:33:52.079615 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:33:52.084081 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:33:52.087550 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:33:52.110709 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:33:52.120375 [debug] [Thread-1  ]: finished collecting timing info
08:33:52.124457 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:33:54.516821 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:33:54.530528 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:54.535666 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:33:54.539555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:54.623418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.08 seconds
08:33:54.629351 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:54.633643 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:33:54.645747 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
08:33:55.996455 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:56.003187 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
08:33:56.012317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:33:56.033372 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:56.039039 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
08:33:56.047485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:33:56.138877 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:33:56.144244 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:56.149778 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:33:56.157215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:33:56.198475 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:33:56.204966 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
08:33:56.214502 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:33:56.234102 [debug] [Thread-1  ]: finished collecting timing info
08:33:56.239201 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:33:56.245437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f67ad3-29d0-4f55-bff1-958ccc403d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038406bb0>]}
08:33:56.252627 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 396[0m in 4.17s]
08:33:56.259165 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:33:56.266933 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:33:56.272132 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
08:33:56.277478 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
08:33:56.281996 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
08:33:56.287554 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
08:33:56.308434 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
08:33:56.320002 [debug] [Thread-1  ]: finished collecting timing info
08:33:56.325347 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
08:33:57.461398 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
08:33:57.474294 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:57.478504 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
08:33:57.482973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:33:57.569610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
08:33:57.575052 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:57.579502 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
08:33:57.591111 [debug] [Thread-1  ]: SQL status: SELECT 396 in 0.01 seconds
08:33:58.321811 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:58.327582 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list" rename to "contact_list__dbt_backup"
08:33:58.334628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:33:58.352972 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:58.357961 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
08:33:58.365233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:33:58.380412 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:33:58.385450 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:58.390164 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:33:58.397272 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:33:58.410565 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:33:58.415350 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
08:33:58.423160 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:33:59.578132 [debug] [Thread-1  ]: finished collecting timing info
08:33:59.583570 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
08:33:59.590023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f67ad3-29d0-4f55-bff1-958ccc403d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038419850>]}
08:33:59.596596 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 396[0m in 3.31s]
08:33:59.604421 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:33:59.612469 [debug] [MainThread]: Acquiring new postgres connection "master"
08:33:59.617775 [debug] [MainThread]: Using postgres connection "master"
08:33:59.622262 [debug] [MainThread]: On master: BEGIN
08:33:59.626497 [debug] [MainThread]: Opening a new connection, currently in state closed
08:33:59.713136 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:33:59.718607 [debug] [MainThread]: On master: COMMIT
08:33:59.723649 [debug] [MainThread]: Using postgres connection "master"
08:33:59.728566 [debug] [MainThread]: On master: COMMIT
08:33:59.734344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:33:59.739212 [debug] [MainThread]: On master: Close
08:33:59.746330 [info ] [MainThread]: 
08:33:59.750961 [info ] [MainThread]: Finished running 2 table models in 9.96s.
08:33:59.755179 [debug] [MainThread]: Connection 'master' was properly closed.
08:33:59.759474 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
08:33:59.796430 [info ] [MainThread]: 
08:33:59.800659 [info ] [MainThread]: [32mCompleted successfully[0m
08:33:59.805744 [info ] [MainThread]: 
08:33:59.809303 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:33:59.813472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038406bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038419ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cee3af0>]}


============================== 2022-03-30 08:34:51.022942 | 6c34f5a1-190f-4854-b572-4032fe26f1ed ==============================
08:34:51.025701 [info ] [MainThread]: Running with dbt=1.0.1
08:34:51.045891 [debug] [MainThread]: running dbt with arguments {'debug': True, 'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'project_dir': '/kensu-dbt-example/dbt-projects/example_marketing', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:34:51.065784 [debug] [MainThread]: Tracking: tracking
08:34:51.138261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40076a7f10>]}
08:34:51.719453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:34:51.724913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:34:51.801177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c34f5a1-190f-4854-b572-4032fe26f1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077a30d0>]}
08:34:51.889096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c34f5a1-190f-4854-b572-4032fe26f1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4007701af0>]}
08:34:51.894941 [info ] [MainThread]: Found 2 models, 1 test, 0 snapshots, 0 analyses, 165 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
08:34:51.905400 [info ] [MainThread]: 
08:34:51.912890 [debug] [MainThread]: Acquiring new postgres connection "master"
08:34:51.947812 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme"
08:34:52.102825 [debug] [ThreadPool]: Using postgres connection "list_testme"
08:34:52.112785 [debug] [ThreadPool]: On list_testme: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme"} */

    select distinct nspname from pg_namespace
  
08:34:52.118982 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:34:52.333374 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.21 seconds
08:34:55.469945 [debug] [ThreadPool]: On list_testme: Close
08:34:55.511202 [debug] [ThreadPool]: Acquiring new postgres connection "list_testme_testme_schema"
08:34:55.655711 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:34:55.675178 [debug] [ThreadPool]: On list_testme_testme_schema: BEGIN
08:34:55.679525 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:34:55.819688 [debug] [ThreadPool]: SQL status: BEGIN in 0.14 seconds
08:34:55.825971 [debug] [ThreadPool]: Using postgres connection "list_testme_testme_schema"
08:34:55.844997 [debug] [ThreadPool]: On list_testme_testme_schema: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "list_testme_testme_schema"} */
select
      'testme' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'testme_schema'
    union all
    select
      'testme' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'testme_schema'
  
08:34:55.859175 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
08:34:55.889170 [debug] [ThreadPool]: On list_testme_testme_schema: ROLLBACK
08:34:55.909447 [debug] [ThreadPool]: On list_testme_testme_schema: Close
08:34:55.987703 [debug] [MainThread]: Using postgres connection "master"
08:34:55.996969 [debug] [MainThread]: On master: BEGIN
08:34:56.018896 [debug] [MainThread]: Opening a new connection, currently in state init
08:34:56.154269 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
08:34:56.159995 [debug] [MainThread]: Using postgres connection "master"
08:34:56.163874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:34:56.178159 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
08:34:56.191539 [debug] [MainThread]: On master: ROLLBACK
08:34:56.208819 [debug] [MainThread]: Using postgres connection "master"
08:34:56.214358 [debug] [MainThread]: On master: BEGIN
08:34:56.222231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
08:34:56.226501 [debug] [MainThread]: On master: COMMIT
08:34:56.230008 [debug] [MainThread]: Using postgres connection "master"
08:34:56.233452 [debug] [MainThread]: On master: COMMIT
08:34:56.249921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:34:56.255838 [debug] [MainThread]: On master: Close
08:34:56.262911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:34:56.268044 [info ] [MainThread]: 
08:34:56.331565 [debug] [Thread-1  ]: Began running node model.Marketing.orders_and_customers
08:34:56.338752 [info ] [Thread-1  ]: 1 of 2 START table model testme_schema.orders_and_customers..................... [RUN]
08:34:56.343990 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.orders_and_customers"
08:34:56.351988 [debug] [Thread-1  ]: Began compiling node model.Marketing.orders_and_customers
08:34:56.356493 [debug] [Thread-1  ]: Compiling model.Marketing.orders_and_customers
08:34:56.427606 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.orders_and_customers"
08:34:56.441239 [debug] [Thread-1  ]: finished collecting timing info
08:34:56.454090 [debug] [Thread-1  ]: Began executing node model.Marketing.orders_and_customers
08:34:59.980471 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.orders_and_customers"
08:34:59.995505 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:00.002717 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: BEGIN
08:35:00.008056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:35:00.106328 [debug] [Thread-1  ]: SQL status: BEGIN in 0.1 seconds
08:35:00.114232 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:00.135168 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */


  create  table "testme"."testme_schema"."orders_and_customers__dbt_tmp"
  as (
    

select *
from "testme"."public"."orders"
left join "testme"."public"."customers"
on customers.id = orders.customer_id
  );
08:35:00.149024 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:35:01.837195 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:01.846514 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers" rename to "orders_and_customers__dbt_backup"
08:35:01.873150 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
08:35:01.916758 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:01.925952 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
alter table "testme"."testme_schema"."orders_and_customers__dbt_tmp" rename to "orders_and_customers"
08:35:01.938149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:35:02.103775 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:35:02.112192 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:02.116911 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: COMMIT
08:35:02.127685 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:35:02.177358 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.orders_and_customers"
08:35:02.185608 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.orders_and_customers"} */
drop table if exists "testme"."testme_schema"."orders_and_customers__dbt_backup" cascade
08:35:02.197919 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:35:02.223772 [debug] [Thread-1  ]: finished collecting timing info
08:35:02.232912 [debug] [Thread-1  ]: On model.Marketing.orders_and_customers: Close
08:35:02.249259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c34f5a1-190f-4854-b572-4032fe26f1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038ac7070>]}
08:35:02.257575 [info ] [Thread-1  ]: 1 of 2 OK created table model testme_schema.orders_and_customers................ [[32mSELECT 386[0m in 5.90s]
08:35:02.267241 [debug] [Thread-1  ]: Finished running node model.Marketing.orders_and_customers
08:35:02.278894 [debug] [Thread-1  ]: Began running node model.Marketing.contact_list
08:35:02.286409 [info ] [Thread-1  ]: 2 of 2 START table model testme_schema.contact_list............................. [RUN]
08:35:02.294218 [debug] [Thread-1  ]: Acquiring new postgres connection "model.Marketing.contact_list"
08:35:02.300299 [debug] [Thread-1  ]: Began compiling node model.Marketing.contact_list
08:35:02.308503 [debug] [Thread-1  ]: Compiling model.Marketing.contact_list
08:35:02.330353 [debug] [Thread-1  ]: Writing injected SQL for node "model.Marketing.contact_list"
08:35:02.342563 [debug] [Thread-1  ]: finished collecting timing info
08:35:02.348128 [debug] [Thread-1  ]: Began executing node model.Marketing.contact_list
08:35:03.350816 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Marketing.contact_list"
08:35:03.366060 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:03.372240 [debug] [Thread-1  ]: On model.Marketing.contact_list: BEGIN
08:35:03.378169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:35:03.472232 [debug] [Thread-1  ]: SQL status: BEGIN in 0.09 seconds
08:35:03.479587 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:03.486413 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */


  create  table "testme"."testme_schema"."contact_list__dbt_tmp"
  as (
    


select first_name, phone
from "testme"."testme_schema"."orders_and_customers"
  );
08:35:03.498605 [debug] [Thread-1  ]: SQL status: SELECT 386 in 0.01 seconds
08:35:04.321118 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:04.331568 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list" rename to "contact_list__dbt_backup"
08:35:04.344329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:35:04.370371 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:04.378832 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
alter table "testme"."testme_schema"."contact_list__dbt_tmp" rename to "contact_list"
08:35:04.389560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
08:35:04.416580 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:35:04.423306 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:04.428921 [debug] [Thread-1  ]: On model.Marketing.contact_list: COMMIT
08:35:04.437505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
08:35:04.452201 [debug] [Thread-1  ]: Using postgres connection "model.Marketing.contact_list"
08:35:04.457397 [debug] [Thread-1  ]: On model.Marketing.contact_list: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "profile_marketing", "target_name": "dev", "node_id": "model.Marketing.contact_list"} */
drop table if exists "testme"."testme_schema"."contact_list__dbt_backup" cascade
08:35:04.466462 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
08:35:05.653993 [debug] [Thread-1  ]: finished collecting timing info
08:35:05.668507 [debug] [Thread-1  ]: On model.Marketing.contact_list: Close
08:35:05.681483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c34f5a1-190f-4854-b572-4032fe26f1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038af5d60>]}
08:35:05.693691 [info ] [Thread-1  ]: 2 of 2 OK created table model testme_schema.contact_list........................ [[32mSELECT 386[0m in 3.39s]
08:35:05.703464 [debug] [Thread-1  ]: Finished running node model.Marketing.contact_list
08:35:05.716250 [debug] [MainThread]: Acquiring new postgres connection "master"
08:35:05.722970 [debug] [MainThread]: Using postgres connection "master"
08:35:05.729054 [debug] [MainThread]: On master: BEGIN
08:35:05.734424 [debug] [MainThread]: Opening a new connection, currently in state closed
08:35:05.820151 [debug] [MainThread]: SQL status: BEGIN in 0.09 seconds
08:35:05.826251 [debug] [MainThread]: On master: COMMIT
08:35:05.830603 [debug] [MainThread]: Using postgres connection "master"
08:35:05.835452 [debug] [MainThread]: On master: COMMIT
08:35:05.842216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
08:35:05.848296 [debug] [MainThread]: On master: Close
08:35:05.860196 [info ] [MainThread]: 
08:35:05.866754 [info ] [MainThread]: Finished running 2 table models in 13.95s.
08:35:05.872571 [debug] [MainThread]: Connection 'master' was properly closed.
08:35:05.879544 [debug] [MainThread]: Connection 'list_testme' was properly closed.
08:35:05.885477 [debug] [MainThread]: Connection 'model.Marketing.contact_list' was properly closed.
08:35:05.930141 [info ] [MainThread]: 
08:35:05.937042 [info ] [MainThread]: [32mCompleted successfully[0m
08:35:05.946201 [info ] [MainThread]: 
08:35:05.952020 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:35:05.958660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x4038af5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x40077017c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x401cee4940>]}
